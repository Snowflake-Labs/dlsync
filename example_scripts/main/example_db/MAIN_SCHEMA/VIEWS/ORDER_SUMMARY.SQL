CREATE OR REPLACE VIEW ${EXAMPLE_DB}.${MAIN_SCHEMA}.ORDER_SUMMARY AS
SELECT
    ORD.ID AS ORDER_ID,
    ORD.USER_ID,
    ORD.PRODUCT_ID,
    ORD.QUANTITY,
    ORD.ORDER_DATE,
    ${EXAMPLE_DB}.${MAIN_SCHEMA}.CALCULATE_ORDER_TOTAL(ORD.QUANTITY, PRD.PRICE) AS TOTAL_PRICE,
    ${EXAMPLE_DB}.${MAIN_SCHEMA}.CALCULATE_DISCOUNT(TOTAL_PRICE, DIS.DISCOUNT_RATE) AS DISCOUNTED_TOTAL_PRICE
FROM ${EXAMPLE_DB}.${MAIN_SCHEMA}.ORDERS ORD
LEFT OUTER JOIN ${EXAMPLE_DB}.${MAIN_SCHEMA}.PRODUCTS PRD
LEFT OUTER JOIN ${EXAMPLE_DB}.${MAIN_SCHEMA}.DISCOUNTS DIS
ON ORD.PRODUCT_ID = DIS.PRODUCT_ID;